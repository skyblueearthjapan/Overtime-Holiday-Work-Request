# 更新版テンプレート作成指示（休日出勤申請・セクション分岐対応）

## フォーム全体の設定

| 項目 | 設定値 |
|------|--------|
| タイトル | 【休日申請】テンプレート |
| 説明 | （空欄。GASが自動上書き） |
| メールアドレスを収集 | OFF |
| 回答を1回に制限 | OFF |
| 質問の順序をシャッフル | OFF |
| 確認メッセージ | 申請を受け付けました。トップ画面に反映されます。 |

---

## セクション1: 基本情報＋工番1（7問＋分岐1問）

セクションタイトル: （なし、またはフォーム冒頭なのでタイトル不要）

### Q1 - 申請種別

| 項目 | 設定値 |
|------|--------|
| タイトル | 申請種別 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | 残業 / 休日 |

### Q2 - 部署

| 項目 | 設定値 |
|------|--------|
| タイトル | 部署 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | （仮）部署名 |

### Q3 - 作業員

| 項目 | 設定値 |
|------|--------|
| タイトル | 作業員 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | （仮）作業員 |

### Q4 - 作業実施日

| 項目 | 設定値 |
|------|--------|
| タイトル | 作業実施日 |
| 種類 | 日付 |
| 必須 | ON |
| 年を含む | ON |

### Q5 - 工番プレフィックス_1

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番プレフィックス_1 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | LW |
| 説明 | 工番の先頭コードを選択してください |

> アンダースコア `_` と数字 `1` は **半角** で入力

### Q6 - 工番番号_1

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番番号_1 |
| 種類 | 記述式（短文） |
| 必須 | ON |
| 回答の検証 | 正規表現 → パターンに一致 |
| パターン | `^[0-9０-９]{5}$` |
| エラーメッセージ | 5桁の数字を入力してください（例：01234） |
| 説明 | 工番の数字5桁を入力（全角・半角どちらでもOK） |

### QB1 - 追加の工番を入力しますか？（分岐用）

| 項目 | 設定値 |
|------|--------|
| タイトル | 追加の工番を入力しますか？ |
| 種類 | ラジオボタン |
| 必須 | ON |
| 選択肢と分岐先 | 下記参照 |

| 選択肢 | セクション移動先 |
|--------|-----------------|
| いいえ（工番1のみ） | → **セクション4（業務内容）**に移動 |
| はい | → **セクション2（工番2）**に移動 |

> Google フォームの選択肢の右にある `…` メニューから「回答に応じてセクションに移動」を設定

---

## セクション2: 工番2（2問＋分岐1問）

セクションタイトル: **工番2**

### Q7 - 工番プレフィックス_2

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番プレフィックス_2 |
| 種類 | プルダウン |
| 必須 | ON（このセクションに来た＝入力する意思あり） |
| 選択肢 | LW |
| 説明 | 2件目の工番の先頭コードを選択 |

### Q8 - 工番番号_2

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番番号_2 |
| 種類 | 記述式（短文） |
| 必須 | ON |
| 回答の検証 | 正規表現 → パターンに一致 |
| パターン | `^[0-9０-９]{5}$` |
| エラーメッセージ | 5桁の数字を入力してください（例：01234） |

### QB2 - さらに追加の工番を入力しますか？（分岐用）

| 項目 | 設定値 |
|------|--------|
| タイトル | さらに追加の工番を入力しますか？ |
| 種類 | ラジオボタン |
| 必須 | ON |
| 選択肢と分岐先 | 下記参照 |

| 選択肢 | セクション移動先 |
|--------|-----------------|
| いいえ（工番2まで） | → **セクション4（業務内容）**に移動 |
| はい | → **セクション3（工番3）**に移動 |

---

## セクション3: 工番3（2問）

セクションタイトル: **工番3**

### Q9 - 工番プレフィックス_3

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番プレフィックス_3 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | LW |
| 説明 | 3件目の工番の先頭コードを選択 |

### Q10 - 工番番号_3

| 項目 | 設定値 |
|------|--------|
| タイトル | 工番番号_3 |
| 種類 | 記述式（短文） |
| 必須 | ON |
| 回答の検証 | 正規表現 → パターンに一致 |
| パターン | `^[0-9０-９]{5}$` |
| エラーメッセージ | 5桁の数字を入力してください（例：01234） |

セクション3の「送信後」設定: → **次のセクションに進む**（セクション4へ自動遷移）

---

## セクション4: 業務内容（4問）

セクションタイトル: **業務内容**

### Q11 - 業務ID

| 項目 | 設定値 |
|------|--------|
| タイトル | 業務ID |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | （仮）業務ID |

### Q12 - 理由

| 項目 | 設定値 |
|------|--------|
| タイトル | 理由 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | （6つ） |

1. 急ぎ作業を要するため
2. 納期遅延解消のため
3. マシントラブル対応のため
4. 業者対応のため
5. 顧客対応のため
6. その他（→補足理由必須）

### Q13 - 補足理由

| 項目 | 設定値 |
|------|--------|
| タイトル | 補足理由 |
| 種類 | 記述式（短文） |
| 必須 | OFF |
| 説明 | 理由で「その他」を選んだ場合は必ず記入してください |

### Q14 - 予定時間

| 項目 | 設定値 |
|------|--------|
| タイトル | 予定時間 |
| 種類 | プルダウン |
| 必須 | ON |
| 選択肢 | **半日 / 1日** |
| 説明 | 休日出勤の予定区分（半日＝4時間 / 1日＝8時間） |

---

## 残業申請テンプレートとの差分一覧

| 項目 | 残業申請 | 休日出勤申請 |
|------|----------|-------------|
| フォームタイトル | 【残業申請】テンプレート | **【休日申請】テンプレート** |
| Q1 申請種別 | GASが「残業」に1択固定 | GASが「**休日**」に1択固定 |
| Q14 予定時間の選択肢 | 0.5 / 1.0 / 1.5 / 2.0 / 2.5 / 3.0 / 3.5 / 4.0 | **半日 / 1日** |
| Q14 予定時間の説明 | 残業予定時間（単位：時間） | **休日出勤の予定区分（半日＝4時間 / 1日＝8時間）** |

> 上記3点以外のセクション構成・質問タイトル・分岐設定・バリデーションはすべて残業申請テンプレートと **完全に同一** です。

---

## 最終チェックリスト

- [ ] セクションは4つ（基本情報＋工番1 / 工番2 / 工番3 / 業務内容）
- [ ] QB1 の「いいえ」→ セクション4へ、「はい」→ セクション2へ
- [ ] QB2 の「いいえ」→ セクション4へ、「はい」→ セクション3へ
- [ ] セクション3の末尾 → セクション4へ自動遷移
- [ ] 工番2/3 のアイテムは **必須ON**（セクションに来た＝入力意思あり）
- [ ] 全タイトルの `_` と数字は **半角**
- [ ] 質問は Q1〜Q14 の14問 ＋ 分岐用 QB1, QB2 の2問 ＝ **計16問**
- [ ] メールアドレス収集は **OFF**
- [ ] Q14 予定時間の選択肢が **半日 / 1日** であること（残業版の 0.5〜4.0 ではない）
- [ ] フォームタイトルが **【休日申請】テンプレート** であること

---

## ユーザー体験

**工番1件の場合（最短ルート）: 3ページ**
```
ページ1: 基本情報＋工番1 → "いいえ"
ページ2: 業務ID・理由・予定時間
→ 送信
```

**工番2件の場合: 4ページ**
```
ページ1: 基本情報＋工番1 → "はい"
ページ2: 工番2 → "いいえ"
ページ3: 業務ID・理由・予定時間
→ 送信
```

**工番3件の場合: 5ページ**
```
ページ1: 基本情報＋工番1 → "はい"
ページ2: 工番2 → "はい"
ページ3: 工番3
ページ4: 業務ID・理由・予定時間
→ 送信
```

---

## GAS連携の確認事項

- GAS側の `Q.HD_HOURS`（`config.gs`）は `'予定時間'` で、質問タイトルは残業と同一
- GAS側の `HD_HOURS`（`config.gs`）は `['半日','1日']` → フォームの選択肢と一致させること
- `plannedMinutesFromHoliday_`（`formSubmit.gs`）が `半日→240分` / `1日→480分` に変換
- Settings の `HOLIDAY_TEMPLATE_FORM_ID` にこのテンプレートフォームのIDを登録すること
- **GASコード変更なし**でそのまま動きます
